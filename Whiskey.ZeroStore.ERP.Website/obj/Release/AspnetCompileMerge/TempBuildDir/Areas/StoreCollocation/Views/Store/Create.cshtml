<link rel="stylesheet" href="/content/styles/jquery/jquery.zTreeStyle.css" />
<link rel="stylesheet" href="/content/editor/themes/default/default.css" />
<link href="/Content/Styles/Bootstrap/bootstrap-multiselect.css" rel="stylesheet" />
<link href="~/Content/Scripts/Layer/skin/default/layer.css" rel="stylesheet" />
<style type="text/css">
	.team_box{
		margin-top: 5px;
	}
	#DataTables_Table_0_length label{
		display: flex;
	}
	#content-wrapper{
		background: rgba(0,0,0,0.2);
	}
		/*.dataTables_info{
	     position: absolute;
    bottom:15%;
    left: 190px;
    width: 15%;
}*/
.btn-group,.btn-group>.dropdown-toggle{
	width: 370px !important;
}
</style>
<div class="row">
    <div class="ruleCreat">
        <div class="col-md-6 panel  panel-list" >
            <div class="col-md-12" style="margin-top: 20px;">
                <div class="form-group">
                    <div class="dropzone-box detailImgs">
                        <div class="dz-default dz-message">
                            <i class="fa fa-cloud-upload"></i>
                            点击这里上传图片<br><span class="dz-text-small">或直接拖放选择</span>
                        </div>
                        <img src="" id="uploadPath" style="float:right;width:30%; display:none;margin-right: 40%;margin-top: 2%;" />
                        <div class="fallback">
                            <input name="file" type="file" multiple="" />
                        </div>
                    </div>
                </div>
                <div>
                    <div class=""></div>
                    <div class="" style="padding-left:0;margin-bottom:10px">
                        @Html.TextBox("ScanNumber", "", new { @placeholder = "请使用扫码枪将商品货号扫入", @class = "scan-number  text-center input-lg form-control", @style = "ime-mode:disabled;margin-top:15px;display:inline;width:83%;height:30%", @onkeyup = "this.value=this.value.toUpperCase().replace(/[\u4e00-\u9fa5]/g,'')" })
                        <input id="sear-ok" class="input-lg form-control" style="display:inline;width:16%;margin-left:auto" type="button" value="&raquo;" />
                    </div>
                    <div class="valign-middle"></div>
                    <div>
                        <input class="form-control" id="selec_prod_list" type="button" value="选择商品……" style="font-weight: bold;" />
                        <input class="form-control" id="selec_prodBatch_list" type="button" value="批量导入……" style="font-weight: bold;" />

                    </div>
                </div>
                <div class="widget-profile-counters ">
                    <div class="col-xs-4" style="padding: 10px 24px;"><label class="label label-info scan-queue-count" style="margin-left: 20px">0</label><br /><div class="team_box">队列数量</div></div>
                    <div class="col-xs-4" style="padding: 10px 24px;"><label class="label label-success scan-valid-count" style="margin-left: 20px">0</label><br /><div class="team_box">有效数量</div></div>
                    <div class="col-xs-4" style="padding: 10px 24px;"><label class="label label-danger scan-invalid-count" style="margin-left: 20px">0</label><br /><div class="team_box">无效数量</div></div>

                </div>
            </div>
        </div>
        <div class="col-md-6 panel  panel-list" style=" height:516px; background: rgba(0,0,0,0.3);">
            <br />
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">搭配名称:</label>
                <div class="col-md-6">
                    @Html.TextBox("StoreCollocationName", "", new { @class = "form-control" })
                </div>
            </div>
            @*<div class="form-group no-margin-hr">
                    <label id="orig_id" class="control-label col-md-2">搭配师:</label>
                    <div class="col-md-6">
                        @Html.TextBox("StoreValueName", "", new { @class = "form-control" })
                    </div>
                    <button id="checkCollcation" type="button" style="padding:4px 0" class="btn btn-primary btn-padding-right col-md-2">选择</button>
                </div>*@
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">店铺:</label>
                <div class="col-md-8">
                    <select id="StoreId" name="StoreId" multiple></select>
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">风格:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Styles", (List<SelectListItem>)ViewBag.Styles, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">颜色:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Colour", (List<SelectListItem>)ViewBag.Colour, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">效果:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Effect", (List<SelectListItem>)ViewBag.Effect, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">季节:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Season", (List<SelectListItem>)ViewBag.Season, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">场合:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Situation", (List<SelectListItem>)ViewBag.Situation, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr">
                <label id="orig_id" class="control-label col-md-2">体型:</label>
                <div class="col-md-8">
                    @Html.DropDownList("Shape", (List<SelectListItem>)ViewBag.Shape, new { @class = "multiselect form-control", @multiple = "multiple" })
                </div>
            </div>
            <div class="form-group no-margin-hr"></div>
            <div class="form-group no-margin-hr"></div>
            <div class="form-group no-margin-hr"></div>
            <div class="form-group no-margin-hr">
                <!--发货按钮-->
                <button id="save_pur" type="button" style="padding:4px 0;margin-left:24%" class="btn btn-success btn-padding-right col-md-2"><i class="fa fa-arrow-right"></i>提交</button>
                <!--保存按钮-->
                <button id="saveord_notsend" type="button" style="padding:4px 0" class="btn btn-primary btn-padding-right col-md-2"><i class="fa fa-arrow-right"></i>取消</button>
            </div>
        </div>

        <div class="col-md-11 panel  panel-list" style="margin-left:0.5%;width: 99%;">
            <div>
                <table class="table pur_list_tab_cre table-list valign-middle" width="100%">
                    <thead>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="/Content/Scripts/Bootstrap/bootstrap-multiselect.js"></script>
<script type="text/javascript" src="/content/editor/kindeditor-min.js"></script>
<script type="text/javascript" src="/content/editor/lang/zh_CN.js"></script>
<script type="text/javascript">
    var hashlist = new $.whiskey.hashtable();
    var $tableInstance = null;
    var uid = "";

    $(function () {
        $("#StoreId").queryAllStore();
        uid = "@ViewBag.uid";
        $('#Styles').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });

        $('#Season').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });
        $('#Situation').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });
        $('#Shape').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });
        $('#Effect').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });
        $('#Colour').multiselect({
            enableFiltering: true,
            includeSelectAllOption: true,
            allSelectedText: "全选",
            nonSelectedText: "请选择",
            filterPlaceholder: "查询",
            nSelectedText: "个被选中",
            selectAllText: "全选",
            maxHeight: 300,
            buttonWidth: 300
        });
        $tableInstance = $(".pur_list_tab_cre").dataTable({
            "aaSorting": [[0, 'desc']],
            "bScrollCollapse": true,
            "bSort": false,
            "bScrollInfinite": false,
            "sAjaxSource": "/StoreCollocation/Store/CollcationViewList",
            "sDom": 'it<"F clearfix datatable-footer"<"col-md-2"l>r<"col-md-3"><"col-md-7 text-right"p>>',
            "fnServerParams": function (aoData) {
                var conditions = new $.whiskey.filter.group();
                aoData.push({ name: "uid", value: uid });
                aoData.push({ name: "conditions", value: JSON.stringify(conditions) });
            },
            "fnDrawCallback": function (data, json) {
                //updateValidCount(data.aoData.length);
                $(".checked-all").click(function () {
                    var checkedStatus = this.checked;
                    $(".table-list tr td input[type=checkbox]").each(function () {
                        this.checked = checkedStatus;
                    });
                });
            },
            "fnRowCallback": function (nRow, aData, iDisplayIndex) {
                $(nRow).addClass("treegrid-" + aData.Id + (aData.ParentId != null ? " treegrid-parent-" + aData.ParentId : ""));
                $("td:eq(1)", nRow).html(iDisplayIndex + 1);
                return nRow;
            },
            "aoColumns": [{
                "bVisible": false,
                "bSearchable": false,
                "sName": "UpdateTime",
                "mData": "Id"
            },
                {
                    "sTitle": $.whiskey.datatable.tplTitleCheckbox(),
                    "sName": "Id",
                    "bSortable": false,
                    "bSearchable": false,
                    "mData": function (data) {
                        return $.whiskey.datatable.tplListCheckbox(data.Id);
                    }
                },
                {
                    "sTitle": "自增编号",
                    "bSortable": false,
                    "sName": "",
                    "mData": function (da) {
                        return "";
                    }
                },
                {
                    "sTitle": "商品编号",
                    "bSortable": false,
                    "sName": "ProductNumber",
                    "mData": function (da) {
                        return da.ProductNumber;
                    }
                },
                {
                    "sTitle": "品牌",
                    "bSortable": false,
                    "sName": "BrandName",
                    "mData": function (da) {
                        if (da.BrandName == undefined)
                            return "";
                        return da.BrandName;
                    }
                },
                {
                    "sTitle": "尺码",
                    "bSortable": false,
                    "sName": "SizeName",
                    "mData": function (da) {
                        if (da.SizeName == undefined)
                            return "";
                        return da.SizeName;
                    }
                },
                {
                    "sTitle": "季节",
                    "bSortable": false,
                    "sName": "SeasonName",
                    "mData": function (da) {
                        if (da.SeasonName == undefined)
                            return "";
                        return da.SeasonName;
                    }
                },
                {
                    "sTitle": "颜色",
                    "bSortable": false,
                    "sName": "ColorName",
                    "mData": function (da) {
                        if (da.ColorName == undefined)
                            return "";
                        return da.ColorName;
                    }
                },
                {
                    "sTitle": "图片",
                    "sName": "ThumbnailPath",
                    "bSortable": false,
                    "bSearchable": false,
                    "mData": function (da) {
                        if (da.ThumbnailPath == "")
                            return "";
                            
                        return " <div class='thumbnail-img_five_box'><div class='thumbnail-img_five'><div class='thumbnail-img_f'><img  class='popimg' src=" + da.ThumbnailPath + " onerror='imgloaderror(this);'> </div></div> </div>";
                    }
                },
                {
                    "sTitle": "操作",
                    "sName": "Access",
                    "bSortable": false,
                    "bSearchable": false,
                    "mData": function (da) {
                        return "<button class='form-control remove_but' data-number='" + da.Id + "' style='color: #5ebd5e' title='删除'><i class='fa fa-life-ring'></i></button>";
                    }
                },
            ]
        });

        $(".detailImgs").dropzone({
            url: "/Upload/Multiple",
            acceptedFiles: "image/jpeg,image/gif,image/png,image/jpg",
            paramName: "file",
            maxFilesize: 2,
            maxFiles: 1,
            autoProcessQueue: true, //开启自动上传（默认为true）
            //addRemoveLinks:false,
            init: function () {
                this.on("sending", function (file, xhr, formData) {
                    formData.append("ExtType", "Image");
                    formData.append("SaveDir", "StoreCollocation");
                });
                this.on("addedfile", function (file) {
                    var dropzone = this;
                    file.previewElement.addEventListener("click", function () {
                        dropzone.removeFile(file);
                    });
                });
                //当上传完成后的事件，接受的数据为JSON格式
                this.on("success", function (file, data) {
                    var dropzone = this;
                    var arrFiles = data.files;
                    var uploadPath = arrFiles[0];
                    var choice = $("#choiceImg").val();

                    var delimg = $("<div class='img-remove'></div>").click(function () {
                        dropzone.emit("removedfile", file, choice, $(this));
                    });
                    $("#uploadPath").css("display", "");
                    $("#uploadPath").attr("src", uploadPath);

                });
                this.on("complete", function (data) {
                    if (data.status == "error") {
                        var errorInfo = $(data.previewElement).find("span[data-dz-errormessage]").text();
                        $.whiskey.web.alert({
                            type: "info",
                            content: errorInfo
                        });
                    }
                });
            },
            removedfile: function (file, choice, obj) {
                _this = this;
                if (confirm("确认要删除吗？")) {
                    var removeIndex = file.previewElement.querySelector("[data-dz-thumbnail]").title;
                    if (removeIndex >= 0) {
                        _this.options.dictFiles.remove("img-" + removeIndex);
                    }
                    $("#uploadPath").css("display", "none");
                    $("#uploadPath").attr("src", "");
                    var _ref;
                    if ((_ref = file.previewElement) != null) {
                        _ref.parentNode.removeChild(file.previewElement);
                    }
                }
                _this.files = [];
                return this._updateMaxFilesReachedClass();
            }
        });
        $("#selec_prodBatch_list").click(function () {
            var dialog = new $.whiskey.web.ajaxDialog({
                caption: "批量导入",
                successTit: "确定",
                successEvent: select_check_Access,
                actionUrl: "/StoreCollocation/Store/BatchImport",
                noneheader: true,
                lockButton: $(this),
                methType: "post",
                formValidator: function () {
                    var $form = $(".modal-form");
                    if (!$form.valid()) {
                        $(".modal-dialog").parent("div").animate({ scrollTop: 20 }, 500);
                        return false;
                    }
                    else {
                        return true;
                    }
                },
                postComplete: function () {
                    //$.whiskey.datatable.reset(false);
                    return true;
                }
            });

        });

        //查看无效配货
        $(".scan-invalid").click(function () {
            var view = new $.whiskey.web.ajaxView({
                caption: "无效列表",
                actionUrl: "/StoreCollocation/Store/InValid?uid=" + uid
            });
        });

        $("#StoreCollocationName").blur(function () {
            $.ajax({
                type: "post",
                url: "@Url.Action("CheckName")",
                data: { name: $(this).val() },
                success: function (data) {
                    if (data > 0) {
                        $(this).val("");
                        LayAlert("搭配规则名称已存在");
                    }
                }
            })
        });

        $("#save_pur").click(function () {
            var StoreId = $("#StoreId ").val() || "";
            var da = [];
            var Styles = $("#Styles").val() || "";
            var CollocationName = $("#StoreCollocationName").val() || "";
            var Colour = $("#Colour").val() || "";
            var Effect = $("#Effect").val() || "";
            var Season = $("#Season").val() || "";
            var Situation = $("#Situation").val() || "";
            var Shape = $("#Shape").val() || "";
            da.push({ "Guid": uid });
            var uploadPath = $("#uploadPath").attr("src") || "";
            if (uploadPath == "") { LayAlert("请上传搭配图片!"); return; }
            else {
                da.push({ "ThumbnailPath": uploadPath });
            }
            if (CollocationName == "") { LayAlert("请填写搭配名称!"); return; }
            else {
                da.push({ "CollocationName": CollocationName });
            }
            if (StoreId == "") { LayAlert("请选择店铺!"); return; }
            else {
                da.push({ "StoreId": StoreId.join(",") });
            }
            if (Styles == "") { LayAlert("请选择风格!"); return; }
            else {
                da.push({ "Styles": Styles.join(",") });
            }
            if (Colour == "") { LayAlert("请选择颜色!"); return; }
            else {
                da.push({ "Colour": Colour.join(",") });
            }
            if (Effect == "") { LayAlert("请选择效果!"); return; }
            else {
                da.push({ "Effect": Effect.join(",") });
            }
            if (Season == "") { LayAlert("请选择季节!"); return; }
            else {
                da.push({ "Season": Season.join(",") });
            }
            if (Situation == "") { LayAlert("请选择场合!"); return; }
            else {
                da.push({ "Situation": Situation.join(",") });
            }
            if (Shape == "") { LayAlert("请选择体型!"); return; }
            else {
                da.push({ "Shape": Shape.join(",") });
            }
            $.ajax({
                url: "/StoreCollocation/Store/Update",
                type: "POST",
                data: { scdo: et(da) },
                success: function (data) {
                    if (data.ResultType == 3) {
                        $("#ViewDiv").load("/StoreCollocation/Store/Index");
                    }
                }
            });
        });
        $("#saveord_notsend").click(function () {
            $("#ViewDiv").load("/StoreCollocation/Store/Index");
        });
        $("#ScanNumber").keyup(function (e) {
            if (e.keyCode == 13)
                $("#sear-ok").click();
        });
        $("#sear-ok").click(function () {
            var scanNumber = $(".scan-number").val();
            if (scanNumber.trim() != "")
                EnterQue(scanNumber);
        });

        //查看有效配货
        $(".scan-valid").click(function () {
            var view = new $.whiskey.web.ajaxView({
                caption: "有效列表",
                actionUrl: "/StoreCollocation/Store/VaildView?uid=" + uid
            });
        });


        $(document).delegate(".remove_but", "click", function () {
            var number = $(this).attr("data-number");
            $.whiskey.web.ajaxConfirm({
                question: "确定要移除选该商品吗",
                notes: "",
                success_event: function () {
                    removeRow(number);
                },
                cancel_event: function () {
                }
            });
        });

        $(window).on("beforeunload", function (e) {
            if (hashlist.size() > 0) {
                var mes = "检测到还有" + hashlist.size() + "条数据正在校验，刷新或者关闭浏览器会丢失这些数据";
                //e.returnValue = mes;
                return mes;
            }
            var t = $.whiskey.tools.other();
            if (t != undefined && t != null && t.length > 0) {
                t = t.substr(1, t.length - 1);
                var mes = "检测到新增数据，编号：" + t + "未保存，刷新或者关闭浏览器会丢失这些数据";
                //e.returnValue = mes;
                return mes;
            }
            var sta = $.whiskey.tools.status();
            if (sta == 1) {
                var mes = "检测到数据已经修改，刷新或者关闭浏览器会丢失这些修改数据";
                //e.returnValue = mes;
                return mes;
            }
        });

        /**
 * //在弹出层中选择商品
 */
        $("#selec_prod_list").click(function () {
            var orderblankNum = $("#hid-ordernum_dat").val();
            var dialog = new $.whiskey.web.ajaxDialog({
                caption: "选择商品",
                successTit: "确定",
                className: "box-dg",
                actionUrl: "/StoreCollocation/Store/GetProductList",
                noneheader: true,
                successEvent: function () {
                    multitudeVaild();
                    $(cur_div_form).show();
                },
                lockButton: $(this),
                formValidator: function () {
                    var $form = $(".modal-form");
                    if (!$form.valid()) {
                        $(".modal-dialog").parent("div").animate({ scrollTop: 20 }, 500);
                        return false;
                    }
                    else {
                        return true;
                    }
                },
                closeEvent: function () {
                    $(cur_div_form).show();
                },
                beforeSend: function () {
                    cur_div_form = $("form[0fashion='fashion-team']").parents(".modal-content");
                    $(cur_div_form).hide();
                },
                postComplete: function () {
                    $(cur_div_form).show();
                    $tableInstance.api().draw(false);
                    return true;
                }
            });
        });
    });


    //将数据压入队列
    function EnterQue(scanNumber) {
        if (scanNumber.length > 0) {
            var barcodeArr = scanNumber.split(',');
            if (barcodeArr.length <= 0) {
                return;
            }

            $.ajax({
                url: "/StoreCollocation/Store/MultitudeVaild",
                type: "POST",
                data: { uid: uid, nums: scanNumber },
                success: function (data) {
                    updateQueueCount(hashlist.size());
                    updateValidCount(data.Data.validCount);
                    updateInvalidCount(data.Data.invalidCount);
                    if (data.ResultType == 3) {
                        $tableInstance.api().draw(false);
                    }
                }
            });
        }
    }



    //将批量导入中选中的元素压入队列
    function select_check_Access() {
        //var checks = $(".pdl:checked");
        var orderblankId = $("#orderblankId").val();
        var num = $("#hid-ordernum_dat").val();
        var tableData = window.gloablDataTableObj.data();
        var barcodes = [];
        for (var i = 0; i < tableData.length; i++) {
            barcodes.push(tableData[i].value);
        }
        $.ajax({
            url: "/StoreCollocation/Store/MultitudeVaild",
            type: "POST",
            data: { uid: uid, nums: barcodes.join(",") },
            success: function (data) {
                updateQueueCount(hashlist.size());
                updateValidCount(data.Data.validCount);
                updateInvalidCount(data.Data.invalidCount);
                if (data.ResultType == 3) {
                    $tableInstance.api().draw(false);
                }
            }
        });
    }

    //更新队列数量
    function updateQueueCount(count) {
        $(".scan-queue-count").animate({
            opacity: "0.3"
        }, 'slow', function () {
            $(".scan-queue-count").animate({
                opacity: "1.0"
            }, 'fast', function () {
                $(".scan-queue-count").text(count);
            });
        });
    }

    // 更新有效数量
    function updateValidCount(validCount) {
        if (parseInt($(".scan-valid-count").text()) != validCount) {
            $(".scan-valid-count").animate({
                opacity: "0.3"
            }, 'slow', function () {
                $(".scan-valid-count").animate({
                    opacity: "1.0"
                }, 'fast', function () {
                    $(".scan-valid-count").text(validCount);
                });
            });
        }
    }

    //更新无效数量
    function updateInvalidCount(invalidCount) {
        if (parseInt($(".scan-invalid-count").text()) != invalidCount) {
            $(".scan-invalid-count").animate({
                opacity: "0.3"
            }, 'slow', function () {
                $(".scan-invalid-count").animate({
                    opacity: "1.0"
                }, 'fast', function () {
                    $(".scan-invalid-count").text(invalidCount);
                });
            });
        }
    }


    //将选择的流水号提交给后台

    function multitudeVaild() {
        var checks = $(".pdl:checked");
        if (checks.length !== 0) {
            var barcodeArr = [];
            for (var i = 0; i < checks.length; i++) {
                var tr = $(checks[i]).parents("tr")[0];
                if ($(tr).treegrid("isLeaf")) {
                    var barcode = $(tr).treegrid("getNodeId");
                    if (barcode != "") {
                        barcodeArr.push(barcode);
                    }
                }
            }
            if (barcodeArr.length !== 0) {
                var id = $("#storeCollocationId").val();
                var orderblankNum = $("#hid-ordernum_dat").val();
                $.ajax({
                    url: "/StoreCollocation/Store/MultitudeVaild",
                    type: "POST",
                    data: { uid: uid, nums: barcodeArr.join(",") },
                    success: function (data) {
                        updateQueueCount(hashlist.size());
                        updateValidCount(data.Data.validCount);
                        updateInvalidCount(data.Data.invalidCount);
                        if (data.ResultType == 3) {
                            $tableInstance.api().draw(false);
                        }
                    }
                });
            }
        }
    }

    function removeRow(trElement) {
        if (trElement != "") {
            $.ajax({
                url: "/StoreCollocation/Store/InfoRemove",
                type: "POST",
                data: { infoId: trElement },
                success: function (data) {
                    if (data.ResultType == 3) {
                        $tableInstance.api().draw(false);
                    }
                }
            });
        }
    }

    function LayAlert(errorInfo) {
        $.whiskey.web.alert({
            type: "info",
            content: errorInfo
        });
    }

    function et(tli) {
        if ($.isArray(tli)) {
            var ret;
            for (i in tli) {
                ret = $.extend({}, ret, tli[i]);
            }
            return ret;
        }
    }
</script>
